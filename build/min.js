/**
 https://github.com/FelixVogel/Matrix
 Copyright (c) 2020 Felix Vogel

 For the full copyright and license information, please view the LICENSE
 file that was distributed with this source code.
*/
var Utility;(function(e){var t=function(){function e(e,t,r,n){if(n===void 0){n=255}this.r=e;this.g=t;this.b=r;this.a=n}e.prototype.fromRGBA=function(e,t,r,n){this.r=Math.max(0,Math.min(255,e));this.g=Math.max(0,Math.min(255,t));this.b=Math.max(0,Math.min(255,r));this.a=Math.max(0,Math.min(255,n));return this};e.prototype.toRGBA=function(e){if(e===void 0){e=this.a}return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"};e.prototype.fromRGB=function(e,t,r){return this.fromRGBA(e,t,r,255)};e.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};e.prototype.fromHex=function(e){if(!e.match(/^#(:?[0-9a-fA-F]{2}){1,3}$/g))return this;e=e.substr(1);for(var t=0;t<e.length;t+=2){var r=parseInt(e.substr(t,2),16);switch(t){case 0:{this.r=r;break}case 2:{this.g=r;break}case 4:{this.b=r;break}default:break}}return this};e.prototype.toHex=function(){return"#"+((this.r<16?"0":"")+this.r.toString(16))+((this.g<16?"0":"")+this.g.toString(16))+((this.b<16?"0":"")+this.b.toString(16))};return e}();e.Color=t;var r=function(){function i(e,t){this.name=e;this.value=t;this.expires=new Date;this.expires.setTime(this.expires.getTime()+7*24*60*60*1e3)}i.getCookie=function(e){var t=document.cookie.indexOf(e+"=");if(t===-1)return null;var r=document.cookie.substr(t);if(r.indexOf("; ")!==-1)r=r.substring(0,r.indexOf("; "));var n=r.split("=");return new i(n[0],n[1])};i.getCookieOrSet=function(e,t){var r=i.getCookie(e);if(!r){r=new i(e,t);r.add()}return r};i.prototype.setExpirationDate=function(e){this.expires=e;return this};i.prototype.getName=function(){return this.name};i.prototype.getValue=function(){return this.value};i.prototype.setValue=function(e){this.value=e;return this};i.prototype.add=function(){document.cookie=this.name+"="+this.value+"; expires="+this.expires.toUTCString()+"; path=/"};i.prototype.remove=function(){var e=new Date;e.setTime(e.getTime()-24*60*60*1e3);document.cookie=this.name+"=; expires="+e.toUTCString()+"; path=/"};return i}();e.Cookie=r;function n(e,t){for(var r=0,n=e.length;r<n;r++){t(e[r],r)}}e.forEach=n})(Utility||(Utility={}));var Color=Utility.Color;var Cookie=Utility.Cookie;var forEach=Utility.forEach;(function(){var h={textColor:new Color(68,255,0),gradientType:0,lineLength:6};var f=[];var c=document.getElementById("matrix-canvas");var v=c.getContext("2d");var r=false;var d=[];var n=function(e){d=[];for(var t=0,r=e.length;t<r;t++){d.push({offsetX:Math.floor(6-v.measureText(e[t]).width/2),char:e[t]})}};h.textColor.fromHex(Cookie.getCookieOrSet("text_color","#44ff00").getValue());var e=document.querySelector("#text-color");e.value=h.textColor.toHex();e.addEventListener("input",function(e){var t=e.target.value;new Cookie("text_color",t).add();h.textColor.fromHex(t)});var t=document.querySelector("#gradient-type");h.gradientType=parseInt(Cookie.getCookieOrSet("gradient_type","0").getValue());t.value=""+h.gradientType;var i=function(e){switch(e){case 0:{h.gradientType=0;forEach(f,function(e){return e.hsv=0});break}case 1:{h.gradientType=1;forEach(f,function(e){return e.hsv=0});break}case 2:{h.gradientType=2;forEach(f,function(e){return e.hsv=360*(e.x/window.innerWidth)});break}}new Cookie("gradient_type",""+e).add()};t.addEventListener("input",function(e){return i(parseInt(e.target.value))});var o=document.querySelector("#line-length");var a=parseInt(Cookie.getCookieOrSet("line_length","25").getValue());o.value=""+a;var s=function(e){var t=Math.floor(2+14/100*e);h.lineLength=t;document.querySelector("#range-value").innerHTML="("+t+")";new Cookie("line_length",""+e).add()};o.addEventListener("input",function(e){return s(parseInt(e.target.value))});var u=document.querySelector("#symbols");u.value=Cookie.getCookieOrSet("symbols","ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z").getValue();n(u.value);u.addEventListener("input",function(e){var t=e.target;if(t.value==="")n("ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z");else n(t.value);new Cookie("symbols",""+t.value).add()});u.addEventListener("focus",function(e){return r=true});u.addEventListener("blur",function(e){return r=false});window.addEventListener("keyup",function(e){if(e.key&&e.key.toLowerCase()==="o"&&!r){var t=document.querySelector("#options");if(t.style["display"]==="")t.style["display"]="none";else t.style["display"]=""}});var l=function(){var e=function(e){c.width=window.innerWidth;c.height=window.innerHeight};e(null);window.addEventListener("resize",e);v.scale(1.2,1.2);var i=function(e,t,r,n,i){if(i===void 0){i="#000000"}v.fillStyle=i;v.fillRect(e,t,r,n)};var o=function(e,t,r){var n=Math.max(.05,Math.min(.5,Math.random()));if(h.gradientType!==0&&r)v.fillStyle="hsla("+r.hsv+", 100%, 50%, "+n+")";else v.fillStyle=h.textColor.toRGBA(n);v.fillRect(e+5,t+4,2,2)};var a=function(){return{letters:0,max:Math.floor(Math.random()*(h.lineLength/2))+h.lineLength/2,letterY:10,erasing:false,eraseY:0,delay:Math.floor(Math.random()*8e3)+2e3}};var t=function(e){var t={x:e,interval:Math.floor(250*Math.random())+150,hsv:0,items:[a()]};f.push(t)};for(var r=1;r<window.innerWidth;r+=12){if(r+12>window.innerWidth)break;for(var n=0;n<window.innerHeight;n+=12)o(r,n);t(r)}var s=function(r){var n=false;forEach(r.items,function(e){if(e.delay<=0){i(r.x,e.letterY,12,12);if(h.gradientType!==0)v.strokeStyle="hsl("+r.hsv+", 100%, 50%)";else v.strokeStyle=h.textColor.toRGB();var t=d[Math.floor(Math.random()*d.length)];v.strokeText(t.char,r.x+t.offsetX,e.letterY);e.letterY+=12;if(e.letters>=e.max&&!e.erasing){e.erasing=true;n=true}else{e.letters+=1}if(e.erasing){i(r.x,e.eraseY,12,12);o(r.x,e.eraseY,r);e.eraseY+=12}}else{e.delay-=250}});if(n)r.items.push(a());r.items=r.items.filter(function(e){return e.eraseY<window.innerHeight});i(r.x,0,12,window.innerHeight,"rgba(0, 0, 0, 0.1)")};var u=0;var l=function(e){var t=e-u;forEach(f,function(e){if(h.gradientType!==0){e.hsv+=2*t;if(e.hsv>=360)e.hsv=0}e.interval-=t;if(e.interval<=0){s(e);e.interval=Math.floor(250*Math.random())+150}});u=e;window.requestAnimationFrame(l)};u=performance.now();window.requestAnimationFrame(l)};s(parseInt(o.value));l();i(h.gradientType)})();