/**
https://github.com/FelixVogel/Matrix
Copyright (c) 2020 Felix Vogel

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
*/
var Utility;(function(e){var t=function(){function e(e,t,n,r){if(r===void 0){r=255}this.r=e;this.g=t;this.b=n;this.a=r}e.prototype.fromRGBA=function(e,t,n,r){this.r=Math.max(0,Math.min(255,e));this.g=Math.max(0,Math.min(255,t));this.b=Math.max(0,Math.min(255,n));this.a=Math.max(0,Math.min(255,r));return this};e.prototype.toRGBA=function(e){if(e===void 0){e=this.a}return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"};e.prototype.fromRGB=function(e,t,n){return this.fromRGBA(e,t,n,255)};e.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};e.prototype.fromHex=function(e){if(!e.match(/^#(:?[0-9a-fA-F]{2}){1,3}$/g))return this;e=e.substr(1);for(var t=0;t<e.length;t+=2){var n=parseInt(e.substr(t,2),16);switch(t){case 0:{this.r=n;break}case 2:{this.g=n;break}case 4:{this.b=n;break}default:break}}return this};e.prototype.toHex=function(){return"#"+((this.r<16?"0":"")+this.r.toString(16))+((this.g<16?"0":"")+this.g.toString(16))+((this.b<16?"0":"")+this.b.toString(16))};return e}();e.Color=t;var n=function(){function i(e,t){this.name=e;this.value=t;this.expires=new Date;this.expires.setTime(this.expires.getTime()+7*24*60*60*1e3)}i.get=function(e){var t=document.cookie.indexOf(e+"=");if(t===-1)return null;var n=document.cookie.substr(t);if(n.indexOf("; ")!==-1)n=n.substring(0,n.indexOf("; "));var r=n.split("=");return new i(r[0],r[1])};i.getOrSet=function(e,t,n){var r=i.get(e);if(!r){r=new i(e,t);r.setExpirationDate(n).add()}return r};i.replace=function(e,t,n){new i(e,t).setExpirationDate(n).add()};i.prototype.setExpirationDate=function(e){if(e)this.expires=e;return this};i.prototype.getName=function(){return this.name};i.prototype.getValue=function(){return this.value};i.prototype.setValue=function(e){this.value=e;return this};i.prototype.add=function(){document.cookie=this.name+"="+this.value+"; expires="+this.expires.toUTCString()+"; path=/"};i.prototype.remove=function(){var e=new Date;e.setTime(e.getTime()-24*60*60*1e3);document.cookie=this.name+"=; expires="+e.toUTCString()+"; path=/"};return i}();e.Cookie=n;function r(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}}e.forEach=r;function i(e){e()}e.capsule=i})(Utility||(Utility={}));var Color=Utility.Color;var Cookie=Utility.Cookie;var forEach=Utility.forEach;var capsule=Utility.capsule;capsule(function(){var c={baseColor:new Color(68,255,0),gradientType:0,gradientInterval:100,lineLength:14,resetOnFocus:true};var f=[];var d=document.getElementById("matrix-canvas");var h=d.getContext("2d");var r={isTyping:false};var v=[];var i=function(e){if(e===null||e.length===0)e="ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z";v=[];for(var t=0,n=e.length;t<n;t++){v.push({offsetX:Math.floor(6-h.measureText(e[t]).width/2),char:e[t]})}};capsule(function(){var t=document.querySelector("#base-color");var e=Cookie.getOrSet("base_color","#44ff00").getValue();t.value=""+e;var n=function(e){c.baseColor.fromHex(e);Cookie.replace("base_color",e)};n(t.value);t.addEventListener("input",function(e){return n(t.value)})});var p=function(e){switch(e){case 0:{c.gradientType=0;forEach(f,function(e){return e.hsv=0});break}case 1:{c.gradientType=1;forEach(f,function(e){return e.hsv=0});break}case 2:{c.gradientType=2;forEach(f,function(e){return e.hsv=360*(e.x/window.innerWidth)});break}}Cookie.replace("gradient_type",""+e)};capsule(function(){var t=document.querySelector("#gradient-type");c.gradientType=parseInt(Cookie.getOrSet("gradient_type","0").getValue());t.value=""+c.gradientType;t.addEventListener("input",function(e){return p(parseInt(t.value))});var n=function(e,t){if(t&&document[t]||!c.resetOnFocus)return;p(c.gradientType)};if(document.hidden!==undefined){document.addEventListener("visibilitychange",function(e){return n(e,"hidden")})}else if(document.webkitHidden){document.addEventListener("webkitvisibilitychange",function(e){return n(e,"webkitHidden")})}else if(document.msHidden){document.addEventListener("msvisibilitychange",function(e){return n(e,"msHidden")})}else{window.addEventListener("focus",function(e){return n(e,null)})}});capsule(function(){var t=document.querySelector("#gradient-interval");var n=document.querySelector('span[data-value-for="gradient-interval"]');var e=parseInt(Cookie.getOrSet("gradient_interval","100").getValue());t.value=""+e;var r=function(e){var t=Math.max(1,Math.min(100,e));c.gradientInterval=t;n.innerHTML="("+t+")";Cookie.replace("gradient_interval",""+t)};r(e);t.addEventListener("input",function(e){return r(parseInt(t.value))})});capsule(function(){var t=document.querySelector("#line-length");var n=document.querySelector('span[data-value-for="line-length"]');var e=parseInt(Cookie.getOrSet("line_length","100").getValue());t.value=""+e;var r=function(e){var t=Math.floor(2+14/100*e);c.lineLength=t;n.innerHTML="("+t+")";Cookie.replace("line_length",""+e)};r(e);t.addEventListener("input",function(e){return r(parseInt(t.value))})});capsule(function(){var t=document.querySelector("#symbols");var n=function(e){i(e);Cookie.replace("symbols",""+e)};document.querySelector("#symbol-reset").addEventListener("click",function(e){t.value="ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z";n(t.value)});t.value=Cookie.getOrSet("symbols","ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z").getValue();n(t.value);t.addEventListener("input",function(e){return n(t.value)});t.addEventListener("focus",function(e){return r.isTyping=true});t.addEventListener("blur",function(e){return r.isTyping=false})});capsule(function(){var t=document.querySelector("#hide-cursor");var e=Cookie.getOrSet("hide_cursor","true").getValue()==="true";var n=function(e){d.style["cursor"]=e?"none":"default";Cookie.replace("hide_cursor",""+e)};n(e);t.addEventListener("input",function(e){return n(t.checked)})});capsule(function(){var t=document.querySelector("#reset-on-focus");var e=Cookie.getOrSet("reset_on_focus","true").getValue()==="true";var n=function(e){c.resetOnFocus=e;Cookie.replace("reset_on_focus",""+e)};n(e);t.addEventListener("input",function(e){return n(t.checked)})});window.addEventListener("keyup",function(e){if(e.key&&e.key.toLowerCase()==="o"&&!r.isTyping){var t=document.querySelector("#options");if(t.style["display"]==="")t.style["display"]="none";else t.style["display"]=""}});var e=function(){var e=function(e){d.width=window.innerWidth;d.height=window.innerHeight};e(null);window.addEventListener("resize",e);h.scale(1.2,1.2);var i=function(e,t,n,r,i){if(i===void 0){i="#000000"}h.fillStyle=i;h.fillRect(e,t,n,r)};var a=function(e,t,n){var r=Math.max(.05,Math.min(.5,Math.random()));if(c.gradientType!==0&&n)h.fillStyle="hsla("+n.hsv+", 100%, 50%, "+r+")";else h.fillStyle=c.baseColor.toRGBA(r);h.fillRect(e+5,t+4,2,2)};var o=function(){return{letters:0,max:Math.floor(Math.random()*(c.lineLength/2))+c.lineLength/2,letterY:10,erasing:false,eraseY:0,delay:Math.floor(Math.random()*8e3)+2e3}};var t=function(e){var t={x:e,interval:Math.floor(250*Math.random())+150,hsv:0,items:[o()]};f.push(t)};for(var n=1;n<window.innerWidth;n+=12){if(n+12>window.innerWidth)break;for(var r=0;r<window.innerHeight;r+=12)a(n,r);t(n)}var u=function(n){var r=false;forEach(n.items,function(e){if(e.delay<=0){i(n.x,e.letterY,12,12);if(c.gradientType!==0)h.strokeStyle="hsl("+n.hsv+", 100%, 50%)";else h.strokeStyle=c.baseColor.toRGB();var t=v[Math.floor(Math.random()*v.length)];h.strokeText(t.char,n.x+t.offsetX,e.letterY);e.letterY+=12;if(e.letters>=e.max&&!e.erasing){e.erasing=true;r=true}else{e.letters+=1}if(e.erasing){i(n.x,e.eraseY,12,12);a(n.x,e.eraseY,n);e.eraseY+=12}}else{e.delay-=250}});if(r)n.items.push(o());n.items=n.items.filter(function(e){return e.eraseY<window.innerHeight});i(n.x,0,12,window.innerHeight,"rgba(0, 0, 0, 0.1)")};var s=0;var l=function(e){var t=e-s;forEach(f,function(e){if(c.gradientType!==0){e.hsv+=t/c.gradientInterval;if(e.hsv>=360)e.hsv=0}e.interval-=t;if(e.interval<=0){u(e);e.interval=Math.floor(250*Math.random())+150}});s=e;window.requestAnimationFrame(l)};p(c.gradientType);s=performance.now();window.requestAnimationFrame(l)};e()});