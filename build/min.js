/**
https://github.com/FelixVogel/Matrix
Copyright (c) 2020 Felix Vogel

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.
*/
var Utility;(function(e){var t=function(){function o(e,t,n,r){if(r===void 0){r=255}this.r=Math.max(0,Math.min(255,e));this.g=Math.max(0,Math.min(255,t));this.b=Math.max(0,Math.min(255,n));this.a=Math.max(0,Math.min(255,r))}o.fromRGBA=function(e,t,n,r){if(r===void 0){r=255}return new o(e,t,n,r)};o.fromHex=function(e){if(!e.match(/^#(:?[0-9a-fA-F]{2}){1,3}$/g))return null;var t,n,r;e=e.substr(1);for(var i=0;i<e.length;i+=2){var a=parseInt(e.substr(i,2),16);switch(i){case 0:{t=a;break}case 2:{n=a;break}case 4:{r=a;break}default:break}}return new o(t,n,r)};o.prototype.toRGBA=function(e){if(e===void 0){e=this.a}return"rgba("+this.r+", "+this.g+", "+this.b+", "+e+")"};o.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};o.prototype.toHex=function(){return"#"+((this.r<16?"0":"")+this.r.toString(16))+((this.g<16?"0":"")+this.g.toString(16))+((this.b<16?"0":"")+this.b.toString(16))};return o}();e.Color=t;var n=function(){function i(e,t){this.name=e;this.value=t;this.expires=new Date;this.expires.setTime(this.expires.getTime()+7*24*60*60*1e3)}i.get=function(e){var t=document.cookie.indexOf(e+"=");if(t===-1)return null;var n=document.cookie.substr(t);if(n.indexOf("; ")!==-1)n=n.substring(0,n.indexOf("; "));var r=n.split("=");return new i(r[0],r[1])};i.getOrSet=function(e,t,n){var r=i.get(e);if(!r){r=new i(e,t);r.setExpirationDate(n).add()}return r};i.replace=function(e,t,n){new i(e,t).setExpirationDate(n).add()};i.prototype.setExpirationDate=function(e){if(e)this.expires=e;return this};i.prototype.getName=function(){return this.name};i.prototype.getValue=function(){return this.value};i.prototype.setValue=function(e){this.value=e;return this};i.prototype.add=function(){document.cookie=this.name+"="+this.value+"; expires="+this.expires.toUTCString()+"; path=/"};i.prototype.remove=function(){var e=new Date;e.setTime(e.getTime()-24*60*60*1e3);document.cookie=this.name+"=; expires="+e.toUTCString()+"; path=/"};return i}();e.Cookie=n;function r(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}}e.forEach=r;function i(e){e()}e.capsule=i})(Utility||(Utility={}));var Color=Utility.Color;var Cookie=Utility.Cookie;var forEach=Utility.forEach;var capsule=Utility.capsule;capsule(function(){var i={};var a={baseColor:new Color(68,255,0),speed:1,gradientType:0,gradientInterval:1,lineLength:14,resetOnFocus:true,rotation:0};var o=document.querySelector("#matrix-canvas");var u=o.getContext("2d");var r={isTyping:false};var s=[];var c=[];var l=function(e){if(e===null||e.length===0)e="ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z";s=[];for(var t=0,n=e.length;t<n;t++){s.push({offsetX:Math.floor(6-u.measureText(e[t]).width/2),char:e[t]})}};var d=function(e,t,n,r,i){if(i===void 0){i="#000000"}u.fillStyle=i;u.fillRect(e,t,n,r)};var v=function(e,t,n){var r=Math.max(.05,Math.min(.5,Math.random()));if(a.gradientType!==0&&n)u.fillStyle="hsla("+n.hsv+", 100%, 50%, "+r+")";else u.fillStyle=a.baseColor.toRGBA(r);u.fillRect(e+5,t+4,2,2)};var f=function(){return{letters:0,max:Math.floor(Math.random()*(a.lineLength/2))+a.lineLength/2,letterY:10,erasing:false,eraseY:0,delay:Math.floor(Math.random()*8e3)+2e3}};var h=function(e){var t={x:e,interval:Math.floor(250*Math.random())+150,hsv:0,items:[f()]};c.push(t)};var p=function(){c=[];for(var e=1,t=o.width;e<t;e+=12){if(e+12>t)break;for(var n=0,r=o.height;n<r;n+=12)v(e,n);h(e)}i.setGradientType(a.gradientType)};var g=function(e){a.rotation=e;o.width=window.innerWidth;o.height=window.innerHeight;o.style["transform"]="rotateZ("+e+"deg)";var t=o.getBoundingClientRect();var n=t.right-t.left;var r=t.bottom-t.top;o.width=n;o.height=r;o.style["transform"]="translate("+(window.innerWidth-n)/2+"px, "+(window.innerHeight-r)/2+"px) rotateZ("+e+"deg)";p()};var e=function(e){o.width=window.innerWidth;o.height=window.innerHeight;g(a.rotation)};capsule(function(){var t=document.querySelector("#base-color");var e=Cookie.getOrSet("base_color","#44ff00").getValue();t.value=""+e;var n=function(e){a.baseColor=Color.fromHex(e);Cookie.replace("base_color",e)};n(t.value);t.addEventListener("input",function(e){return n(t.value)})});capsule(function(){var r=document.querySelector("#speed");var i=document.querySelector('span[data-value-for="speed"]');var e=parseInt(Cookie.getOrSet("speed","0").getValue());var t=function(e){var t=e-e%25;r.value=""+t;var n=Math.max(1,Math.pow(2,t/25));a.speed=n;i.innerHTML="(x "+n+")";Cookie.replace("speed",""+t)};t(e);r.addEventListener("input",function(e){return t(parseInt(r.value))})});capsule(function(){var n=function(e){switch(e){case 0:{a.gradientType=0;forEach(c,function(e){return e.hsv=0});break}case 1:{a.gradientType=1;forEach(c,function(e){return e.hsv=0});break}case 2:{a.gradientType=2;forEach(c,function(e){return e.hsv=360*(e.x/o.width)});break}}Cookie.replace("gradient_type",""+e)};i["setGradientType"]=n;var t=document.querySelector("#gradient-type");a.gradientType=parseInt(Cookie.getOrSet("gradient_type","0").getValue());t.value=""+a.gradientType;t.addEventListener("input",function(e){return n(parseInt(t.value))});var r=function(e,t){if(t&&document[t]||!a.resetOnFocus)return;n(a.gradientType)};if(document.hidden!==undefined){document.addEventListener("visibilitychange",function(e){return r(e,"hidden")})}else if(document.webkitHidden){document.addEventListener("webkitvisibilitychange",function(e){return r(e,"webkitHidden")})}else if(document.msHidden){document.addEventListener("msvisibilitychange",function(e){return r(e,"msHidden")})}else{window.addEventListener("focus",function(e){return r(e,null)})}});capsule(function(){var r=document.querySelector("#gradient-interval");var i=document.querySelector('span[data-value-for="gradient-interval"]');var e=parseInt(Cookie.getOrSet("gradient_interval","0").getValue());r.value=""+e;var t=function(e){var t=e-e%25;r.value=""+t;var n=Math.max(1,Math.pow(2,t/25));a.gradientInterval=n;i.innerHTML="(x "+n+")";Cookie.replace("gradient_interval",""+t)};t(e);r.addEventListener("input",function(e){return t(parseInt(r.value))})});capsule(function(){var n=document.querySelector("#line-length");var r=document.querySelector('span[data-value-for="line-length"]');var e=parseInt(Cookie.getOrSet("line_length","100").getValue());n.value=""+e;var t=function(e){var t=Math.floor(30/100*e);n.value=""+Math.ceil(t/30*100);t+=2;a.lineLength=t;r.innerHTML="("+t+")";Cookie.replace("line_length",""+e)};t(e);n.addEventListener("input",function(e){return t(parseInt(n.value))})});capsule(function(){var t=document.querySelector("#symbols");var e=Cookie.getOrSet("symbols","ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z").getValue();var n=function(e){if(!e||e.length===0)return;l(e);Cookie.replace("symbols",""+e)};document.querySelector("#symbol-set").addEventListener("click",function(e){n(t.value)});document.querySelector("#symbol-reset").addEventListener("click",function(e){t.value="ｦｱｳｴｵｶｷｹｺｻｼｽｾｿﾀﾂﾃﾅﾆﾇﾈﾊﾋﾎﾏﾐﾑﾒﾓﾔﾕﾗﾘﾜ日(+*;)-|2589Z";n(t.value)});t.value=e;n(e);t.addEventListener("focus",function(e){return r.isTyping=true});t.addEventListener("blur",function(e){return r.isTyping=false})});capsule(function(){var t=document.querySelector("#hide-cursor");var e=Cookie.getOrSet("hide_cursor","true").getValue()==="true";t.checked=e;var n=function(e){document.querySelector(".matrix-container").style["cursor"]=e?"none":"default";Cookie.replace("hide_cursor",""+e)};n(e);t.addEventListener("input",function(e){return n(t.checked)})});capsule(function(){var t=document.querySelector("#reset-on-focus");var e=Cookie.getOrSet("reset_on_focus","true").getValue()==="true";t.checked=e;var n=function(e){a.resetOnFocus=e;Cookie.replace("reset_on_focus",""+e)};n(e);t.addEventListener("input",function(e){return n(t.checked)})});capsule(function(){var n=document.querySelector("#rotation");var e=parseInt(Cookie.getOrSet("rotation","0").getValue());var r=document.querySelector('span[data-value-for="rotation"]');n.value=""+e;var t=function(e){var t=Math.trunc(e/100*360);n.value=""+t/360*100;r.innerHTML="("+t+" &deg;)";Cookie.replace("rotation",n.value);return t};var i=function(e){g(t(e))};document.querySelector("#rotation-set").addEventListener("click",function(e){i(parseInt(n.value))});document.querySelector("#rotation-reset").addEventListener("click",function(e){n.value="0";i(0)});i(e);n.addEventListener("input",function(e){r.innerHTML="("+t(parseInt(n.value))+" &deg;)"})});window.addEventListener("keyup",function(e){if(e.key&&e.key.toLowerCase()==="o"&&!r.isTyping){var t=document.querySelector("#options");if(t.style["display"]==="")t.style["display"]="none";else t.style["display"]=""}});var t=function(){u.scale(1.2,1.2);e();window.addEventListener("resize",e);var n=function(n){var r=false;forEach(n.items,function(e){if(e.delay<=0){d(n.x,e.letterY,12,12);if(a.gradientType!==0)u.strokeStyle="hsl("+n.hsv+", 100%, 50%)";else u.strokeStyle=a.baseColor.toRGB();var t=s[Math.floor(Math.random()*s.length)];u.strokeText(t.char,n.x+t.offsetX,e.letterY);e.letterY+=12;if(e.letters>=e.max&&!e.erasing){e.erasing=true;r=true}else{e.letters+=1}if(e.erasing){d(n.x,e.eraseY,12,12);v(n.x,e.eraseY,n);e.eraseY+=12}}else{e.delay-=250}});if(r)n.items.push(f());n.items=n.items.filter(function(e){return e.eraseY<o.height});d(n.x,0,12,o.height,"rgba(0, 0, 0, 0.1)")};var r=0;var i=function(e){var t=e-r;forEach(c,function(e){if(a.gradientType!==0){e.hsv+=t/100*a.gradientInterval;if(e.hsv>=360)e.hsv=0}e.interval-=t*a.speed;if(e.interval<=0){n(e);e.interval=Math.floor(250*Math.random())+150}});r=e;window.requestAnimationFrame(i)};r=performance.now();window.requestAnimationFrame(i)};t()});